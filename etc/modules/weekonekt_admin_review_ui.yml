version: 1.0
type: module
category: ui
name: weekonekt_admin_review_ui
spec:
  init:
    model:
      theme: "dark"
      selected: "reviews"
      review: {}
      id: "none"
  decoders:
    show_review:
      object:
        effect:
          keyword: ui
        event:
          object:
            name: 
              keyword: show_review
            id:
              any: text
    review:
      object:
        effect:
          keyword: ws
        data:
          object:
            review:
              object:
                title:
                  any: text
  update:
    show_review:
      model:
        id:
          key: id
          in: event
        content_view:
          keyword: review_loading_view
      cmds:
        - effect: ws
          encoder: review_query
        - effect: ui
          encoder: review_layout_view
    review:
      model:
        review:
          key: review
          in: data
        content_view: 
          keyword: review_view
      cmds:
        - effect: ui
          encoder: review_layout_view
  encoders:
    review_query:
      object:
        app:
          text: "weekonekt"
        action:
          text: "review"
        id:
          key: id
    review_view:
      view:
        tag: div
        children:
          - tag: h1
            children:
              - text:
                  key: title
                  in: 
                    key: review
                    in: data
    review_loading_view:
      view:
        tag: div
        children:
          - tag: span
            attrs:
              class: "link"
            children:
              - text: "Loading review..."
    review_layout_view: 
      view:
        view: weekonekt_admin_layout
        params:
          object:
            theme:
              key: theme
            selected:
              key: selected
            message:
              key: message
            content_view:
              key: content_view 
            contents:
              object:
                review:
                  key: review
                id:
                  key: id
