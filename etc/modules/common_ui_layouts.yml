version: 1.0
type: module
category: client
name: common_ui_layouts 
spec:
  init:
    model:
      object:
        inspector:
          object:
            visibility: "hidden"
            view: "empty_view"
            content_key: "empty" 
  decoders:
    toggle_inspector:
      object:
        effect: ui
        event:
          object:
            name: "toggle-inspector"
            view:
              any: text 
            content: 
              any: text
  update:
    toggle_inspector:
      - when:
          or:
            - eq: 
              - key: visibility 
                in: inspector
              - text: "hidden"
            - not:
                eq:
                  - key: view
                    in: inspector
                  - key: view
                    in: event
        model:
          object:
            inspector: 
              object:
                visibility: "visible"
                view:
                  key: view
                  in: event
                content_key:
                  key: content
                  in: event
        cmds:
          - effect: ui
      - model:
          object:
            inspector:
              object:
                visibility: "hidden"
                view: "empty_view"
                content_key: "empty" 
        cmds:
          - effect: ui
  encoders:
    empty_view:
      view:
        tag: div
        children: []
    dialog:
      view:
        tag: div
        attrs:
          class: "dialog"
        children:
          - tag: h3
            attrs:
              class: "title"
            children:
              - text: 
                  key: title
          - tag: span
            attrs:
              class: "subtitle"
            children:
            - text:
                key: subtitle
    json_view:
      view:
        tag: div
        attrs:
          class: "json"
        children:
          - code:
              lang: "json" 
              source:
                key: content 
    text_view:
      view:
        tag: div
        attrs:
          class: "text"
        children:
          - text:
              key: content
    timestamp_view:
      view:
        tag: div
        attrs:
          class: "timestamp"
        children:
          - timestamp:
              format: human
              value:
                key: content
    prop:
      view:
        tag: div
        attrs:
          class: "prop"
        children:
          - tag: div
            attrs:
              class: "value"
            children:
              - view: 
                  key: view
                  in: item
                params:
                  object:
                    content:
                      key: content
                      in: item
          - tag: div
            attrs:
              class: "name"
            children:
              - text:
                  key: title
                  in: item
    props:
      view:
        tag: div
        attrs:
          class: "props"
        children:
          - tag: div
            attrs:
              class: "title"
            children:
              - text:
                  key: title
          - tag: section
            children:
              loop: props
              with: prop
    alert:
      view:
        tag: div
        attrs:
          class: "alert"
        children:
          - text:
              key: message
    panel_header:
      view:
        tag: div
        attrs:
          class: "panel-header"
        children:
          - tag: div
            attrs:
              class: "panel-icon"
            children:
              - tag: i
                attrs:
                  class:
                    key: icon
                    in: header
          - tag: div
            attrs:
              class: "panel-title"
            children:
              - tag: h3
                children:
                  - text:
                      key: title
                      in: header
              - tag: span
                children:
                  - text:
                      key: subtitle
                      in: header
    panel:
      view:
        tag: div
        attrs:
          class: 
            format:
              pattern: "panel ~a"
              params:
                - key: style
        children:
          - view: panel_header
            when:
              is_set: header
            params:
              object:
                header:
                  maybe:
                    key: header
          - tag: div
            attrs:
              class: "panel-body"
            children:
              - view: alert
                when:
                  is_set: message
                params:
                  object:
                    message:
                      maybe:
                        key: message
              - view:
                  key: view
                params:
                  key: content
    item:
      view:
        tag: div
        attrs:
          class: "item"
        children:
          - view:
              key: content_view
              in: item
            params:
              key: content
              in: item
    form:
      view:
        tag: div
        attrs:
          class: "form"
        children:
          - tag: div
            attrs:
              class: "fields"
            children:
              loop:
                key: fields
              with: item
          - tag: div
            attrs:
              class: "actions"
            children:
              loop:
                key: actions
              with: item
    simple:
      view:
        tag: div
        attrs:
          class: "layout"
        children:
          - tag: div
            attrs:
              class: "simple columns"
            children:
              - tag: div
                attrs:
                  class: "column col-2 col-xl-2 col-lg-2 col-md-1 col-sm-1 col-xs-1"
              - tag: div
                attrs:
                  class: "column col-8 col-xl-8 col-lg-10 col-md-10 col-sm-10 col-xs-10"
                children:
                  - view:
                      key: content_view
                    params:
                      key: content
              - tag: div
                attrs:
                  class: "column col-2 col-xl-2 col-lg-2 col-md-1 col-sm-1 col-xs-1"
    inspector:
      view:
        tag: aside
        attrs:
          class:
            either:
              - when:
                  eq:
                    - text: "hidden"
                    - key: status
                text: "right inspector inactive"
              - text: "right inspector active"
        children:
          - view:
              key: view
            params:
              key: content
    brand:
      view:
        tag: div
        attrs:
          class: "brand"
        children:
          - tag: div
            children:
              - text:
                  key: brand
    nav:
      view:
        tag: div
        attrs:
          class: "navigation"
        children:
          - tag: button
            attrs:
              onclick: 
                object:
                  name: "toggle-inspector"
                  view: "activity_view"
                  content: "activity"
            children:
              - tag: i
                attrs:
                  class: "fas fa-bars"
          - tag: button
            attrs:
              class: "switch-project"
              onclick: 
                object:
                  name: "toggle-inspector"
                  view: "filters_view"
                  content: "filters"
            children:
              - text: 
                  key: filter
                  in: prefs
#          - view: avatar
#            params:
#              object:
#                size: rg
#                initials:
#                  key: initials
    
    menu_item:
      view:
        tag: div
        attrs:
          onclick:
            key: onclick
            in: item
          class: 
            either:
              - when:
                 eq:
                   - key: active
                     in: item
                   - keyword: true
                text: "item active"
              - text: "item"
        children:
          - tag: a
            attrs:
              href: "#"
            children:
              - text:
                  key: title
                  in: item
    menu:
      view:
        tag: div
        attrs:
          class: "menu-bar"
        children:
          loop: items
          with: menu_item

    item_view:
      view:
        view:
          key: name
          in: item
        params:
          key: content
          in: item
    main:
      view:
        tag: div
        attrs:
          class: "main"
        children:
          - tag: div
            attrs:
              class: "heading"
            children:
              - tag: div
                attrs:
                  class: "icon"
                children:
                  - tag: i
                    attrs:
                      class:
                        key: icon
              - tag: div
                attrs:
                  class: "title"
                children:
                  - tag: h3
                    children:
                      - text:
                          key: title
                  - tag: span
                    children:
                      - text:
                          key: subtitle
          - tag: div
            attrs:
              class: "content columns"
            children:
              loop: views
              with: item_view
    admin:
      view:
        tag: div
        attrs:
          class: "layout admin"
        children:
          - tag: header
            children:
              - view: brand
                params:
                  brand: 
                    key: brand
                    in: header
              - view: nav
                params:
                  object:
                    prefs:
                      key: prefs
                    initials: "PG"
          - tag: div
            attrs:
              class: "wrap"
            children:
              - tag: aside
                attrs:
                  class: "left"
                children:
                  - view: menu
                    params:
                      object:
                        items:
                          key: menu
              - tag: section
                attrs:
                  class:
                    either:
                      - when:
                          eq:
                            - text: "visible"
                            - key: visibility 
                              in:
                                key: status
                                in: inspector
                        text: "content with-inspector"
                      - text: "content"
                children:
                  - view:
                      key: content_view
                    params:
                      key: content
              - view: inspector
                params:
                  object:
                    status:
                      key: visibility
                      in:
                        key: status
                        in: inspector
                    content:
                      key:
                        key: content_key
                        in:
                          key: status
                          in: inspector
                      in:
                        key: content
                        in: inspector
                    view:
                      key: view
                      in:
                        key: status
                        in: inspector
