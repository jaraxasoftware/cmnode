version: 1.0
type: module
category: ui
name: nkpanel_ui_inspector
spec:
  encoders:
    inspector_content:
      object:
        empty: {}
        activity:
          object:
            active:
              object:
                max:
                  sum:
                    - key: max
                      in:
                        key: active
                        in: test_activity
                    - key: max
                      in:
                        key: active
                        in: backups_activity
                    - key: max
                      in:
                        key: active
                        in: restores_activity
                items:
                  merged_list:
                    - iterate:
                        key: items
                        in:
                          key: active
                          in: test_activity
                      with:
                        encoder: test_activity_item_view
                    - iterate:
                        key: items
                        in: 
                          key: active
                          in: backups_activity  
                      with:
                        encoder: backup_activity_item_view
                    - iterate:
                        key: items
                        in: 
                          key: active
                          in: restores_activity  
                      with:
                        encoder: restore_activity_item_view
            pending:
              object:
                max:
                  sum:
                    - key: max
                      in:
                        key: pending 
                        in: test_activity
                    - key: max
                      in:
                        key: pending
                        in: backups_activity
                    - key: max
                      in:
                        key: pending
                        in: restores_activity
                items:
                  merged_list:
                    - iterate:
                        key: items
                        in:
                          key: pending
                          in: test_activity
                      with:
                        encoder: test_activity_item_view
                    - iterate:
                        key: items
                        in: 
                          key: pending
                          in: backups_activity
                      with:
                        encoder: backup_activity_item_view
                    - iterate:
                        key: items
                        in: 
                          key: pending
                          in: restores_activity
                      with:
                        encoder: restore_activity_item_view
        filters:
          key: filters
    activity_detail:
      view:
        tag: div
        attrs:
          key: 
            key: id
        children:
          - view: icon-right
            params:
              object:
                size: 2x 
                icon:
                  key: icon
          - tag: div
            children:
              - tag: h6
                children:
                  - text:
                      key: title
              - tag: p
                children:
                  - text:
                      key: subtitle
              - tag: span
                children:
                  - timestamp:
                      format: human
                      value:
                        key: date
              - view: link-button-wide
                params:
                  object:
                    style: "danger"
                    size: "sm"
                    title: "Cancel"
                    onclick:
                      object:
                        name:
                          key: action
                        id:
                          key: id

                  
    activity_item: 
      view:
        view: panel
        params:
          object:
            style: "activity-item filled"
            view: activity_detail
            content:
              key: item
    activity_view:
      view:
        tag: div
        attrs:
          class: "activity"
        children:
          - tag: div
            children:
              - tag: div
                attrs:
                  class: "icon"
                children:
                  - tag: i
                    attrs:
                      class: "fas fa-tasks"
              - tag: div
                attrs:
                  class: "title"
                children:
                  - tag: h3
                    children:
                      - text: "Activity"
                  - tag: span
                    children:
                      - text: "System activity in realtime"
          - tag: section
            attrs:
              class: "items"
            children:
              - view: progressbar
                params:
                  object:
                    value:
                      sum:
                        - size_of:
                            key: items 
                            in: active
                        - size_of:
                            key: items
                            in: pending
                    max:
                      sum:
                        - key: max
                          in: active 
                        - key: max
                          in: pending
              - tag: h4
                children:
                  - text: "Active" 
                  
              - tag: section
                children:
                  loop:
                    key: items
                    in: active
                  with: activity_item
              - tag: h4
                children:
                  - text: "Waiting" 
              - tag: section
                children:
                  loop:
                    key: items
                    in: pending 
                  with: activity_item
