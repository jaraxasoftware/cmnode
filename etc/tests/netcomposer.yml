version: 1.0
type: test
name: netcomposer 
spec:
  config:
    retries: 1 
    wait: 200
  facts:
    baseUrl:
      key: url
      in:
        key: nc
        in: settings
    baseHeaders:
      object:
        authorization:
          basic-auth:
            key: auth
            in:
              key: security
              in: settings
  scenarios:
    - title: "Should have a core api"
      tags:
        - netcomp
        - v10
        - core
      steps:
        - title: "List all api groups"
          http:
            method: get
            url:
              format: "~s/apis"
              params:
                - key: baseUrl
                  in: facts
            headers:
              key: baseHeaders
              in: facts
        - title: "Expect a core api"
          expect:
            match:
              key: latest
              in: data
            with:
              object:
                status: 201
                body:
                  kind: "APIGroupList"
                  groups:
                    list:
                      with:
                        object:
                          name: "core"
                          preferredVersion:
                            groupVersion: "core/v1a1"
