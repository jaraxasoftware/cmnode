version: 1.0
type: test 
name: tracker
spec:
  backgrounds:
    - title: "admin online"
      steps:
        - app: admin
          status: online
    - title: "admin empty"
      steps:
        - send:
            to:
              app: admin
            object:
              action:
                text:
                  literal: "reset"
              token:
                text:
                  literal: "87fb5ce6-d847-494b-ac35-a1a37186c276"
          expect:
            - eq:
                - path: "status"
                - text:
                    literal: "ok"
    - title: "admin user john"
      steps:
        - send:
            to:
              app: admin
            object:
              action: 
                text:
                  literal: register
              first: 
                text:
                  literal: John
              last: 
                text:
                  literal: Chricthon
              username: 
                text:
                  literal: john@farscape.com
              password: 
                text:
                  literal: foo
              password_confirm: 
                text:
                  literal: foo
          expect:
            - present:
                path: "user.id"
                 
    - title: "john logged in"
      steps:
        - send:
            to: 
              app: admin
            object:
              action: 
                text: 
                  literal: login
              username: 
                text: 
                  literal: john@farscape.com
              password: 
                text:
                  literal: foo
          expect:
            - present:
                path: "user.id"
  scenarios:
    - title: "List basic tracker objects, as admin"
      tags: admin, tracker, projects, project, list
      backgrounds:
        - "admin online"
        - "admin empty"
        - "admin user john"
        - "john logged in"
      steps:
        - title: "Given my projects"
          send:
            to: 
              app: admin
            object:
              action: 
                text: 
                  literal: projects
          expect:
            - present:
                path: "projects"
