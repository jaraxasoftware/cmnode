version: 1.0
type: module
category: ui
name: apps_ui
spec:
  init:
    model:
      apps: 
        list: []
      nodes:
        list: []
  update:
    apps:
      model:
        apps:
          from: data
          at: 
            from: data
      cmds:
        - effect: ui
          encoder: apps_view
    show_apps:
      cmds:
        - effect: ui
          encoder: apps_view
        - effect: ws
          encoder: apps
    ready:
      cmds:
        - effect: ui
          encoder: apps_view
        - effect: ws
          encoder: apps
  encoders:
    sidebar_icon:
      view:
        tag: div
        attrs:
          class: "sidebar-icon c-hand"
          onclick:
            from: name
          key: 
            from: name
        children:
          - tag: i
            attrs:
              class: 
                from: style
          - tag: div
            children:
              - text:
                  from: title
    sidebar:
      view:
        tag: div
        attrs:
          class: "text-center"
          key: "sidebar"
        children:
          - view: sidebar_icon
            params:
              object:
                name: "apps"
                style: "icono-gear"
                title: "Apps"
          - view: sidebar_icon
            params:
              object:
                name: "ports"
                style: "icono-rss"
                title: "Ports"
          - view: sidebar_icon
            params:
              object:
                name: "tables"
                style: "icono-list"
                title: "Tables"
          - view: sidebar_icon
            params:
              object:
                name: "nodes"
                style: "icono-imac"
                title: "Nodes"
    layout:
      view:
        tag: div
        attrs:
          class: "off-canvas"
          key: "layout"
        children:
          - tag: div
            attrs:
              id: "sidebar"
              class: "off-canvas-sidebar active"
            children:
              - view: sidebar
          - tag: div
            attrs:
              class: "off-canvas-content"
            children:
              - view: user_message
                params:
                  object:
                    message:
                      from: message
              - view:
                  from: content_view
                params:
                  object:
                    data:
                      from: contents
    main:
      view:
        tag: div
        attrs:
          key: 
            from: view 
        children:
          - tag: h2
            attrs:
              class: "content-view"
            children:
              - text:
                  from: title
          - view:
              from: view
            params:
              object:
                data:
                  from: data

    section:
      view:
        tag: div
        attrs:
          key: 
            from: view 
        children:
          - tag: section
            attrs:
              class: "section-view"
            children:
              - view:
                  from: view
                params:
                  object:
                    data:
                      from: data
    table:
      view: 
        tag: div
        attrs:
          class: "table-view"
        children:
          - tag: table
            children:
              - tag: thead
                children:
                  loop:
                    from: headers
                  with: table_header
              - tag: tbody
                children:
                  loop:
                    from: items
                  with:
                    from: item_view

    table_header:
      view:
        tag: th
        children:
          - text:
              from: title
              at: item
    app_icon:
      map:
        value:
          from: category
          at: item
        options:
          ui: "icon-dark icono-imacBold"
          api: "icon-dark icono-terminal"
    app_table_item_view:
      view:
        tag: "tr"
        attrs:
          key:
            from: name
            at: item
        children:
          - tag: td
            children:
              - tag: a
                attrs:
                  class: "c-hand"
                  onclick:
                    encoder: app_selection
                children:
                  - text:
                      from: name
                      at: item
          - tag: td
            children:
              - text:
                  from: category
                  at: item
    apps_table_view:
      view:
        view: table
        params:
          object:
            headers:
              list:
                - object:
                    title: 
                      text:
                        literal: "Name"
                - object:
                    title:
                      text: 
                        literal: "Category"
            items:
              from: data
            item_view:
              keyword: app_table_item_view
                    
    apps_section_view:
      view:
        view: section
        params:
          object:
            view:
              keyword: apps_table_view
            data:
              from: data
    apps_main_view:
      view:
        view: main
        params:
          object:
            title:
              text:
                literal: "Apps"
            view:
              keyword: apps_table_view
            data:
              from: data
    apps_view: 
      view:
        view: layout
        params:
          object:
            message:
              from: message
            content_view:
              keyword: apps_main_view
            contents:
              from: apps
    node_table_item_view:
      view:
        tag: "tr"
        attrs:
          key:
            from: name
            at: item
        children:
          - tag: td
            children:
              - text:
                  from: name
                  at: item
          - tag: td
            children:
              - text:
                  from: status
                  at: item
    nodes_table_view:
      view:
        view: table
        params:
          object:
            headers:
              list:
                - object:
                    title: 
                      text:
                        literal: "Name"
                - object:
                    title:
                      text: 
                        literal: "Status"
            items:
              from: data
            item_view:
              keyword: node_table_item_view
    nodes_main_view:
      view:
        view: main
        params:
          object:
            title:
              text:
                literal: "Nodes"
            view:
              keyword: nodes_table_view
            data:
              from: data
    nodes_view: 
      view:
        view: layout
        params:
          object:
            message:
              from: message
            content_view:
              keyword: nodes_main_view
            contents:
              from: nodes
    apps:
      object: 
        action:
          keyword: apps
    nodes:
      object: 
        action:
          keyword: nodes
    app_selection:
      object:
        name:
          keyword: show_app
        app:
          from: item 
  decoders:
    ready:
      object:
        effect:
          keyword: events
        event:
          keyword: user_logged_in
    show_apps:
      object:
        effect:
          keyword: ui
        event:
          text:
            literal: "apps"
    apps:
      object:
        effect:
          keyword: ws
        data:
          object:
            type: 
              text: 
                literal: apps
            data:
              list:
                object:
                  name: 
                    text: any
                  category:
                    text: any
